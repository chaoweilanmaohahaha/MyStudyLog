# DHCP

DHCP：动态主机配置协议（Dynamic Host Configuration Protocol）

想到之前的BOOTP协议和RARP协议可以帮助一个无磁盘的主机获取IP地址。现在网络中使用了NAT的缘故，因此可能会为局域网中的主机在启动时获取IP地址来进行通信，这时需要动态来分配IP地址，此时要使用DHCP协议。它作为UDP的负载。

### 工作原理

在这个协议中需要存在一个DHCP服务器，它维持了一个IP地址池，需要由客户端来申请一个有一定租用时间的IP地址。那么申请的过程一共要经历四个阶段：

1. DHCP发现：当主机启动的时候，需要广播来寻找DHCP服务器的位置，这个广播包会包括租约信息，客户端的mac，以及源地址用0.0.0.0，目的地址为广播地址。
2. DHCP交付：DHCP服务器会向申请地址的客户端提供IP地址信息，它会给一个地址池中还没分配的地址，其中还包含了客户的mac，子网掩码，租期，服务器IP
3. DHCP请求：客户端选择第一个收到的DHCP交付报文，然后把信息广播到网络中，意思是不接受其他的DHCP服务器交付报文了，
4. DHCP响应：服务器响应请求。

