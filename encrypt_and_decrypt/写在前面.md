# 前言

这一节总结一下第一章讲到的一些预备知识，可能对于后面的学习有帮助，所以先记录一下。

## 关于逆向工程

对于软件来说，逆向工程就是将可执行程序进行反编译，来获得源代码的过程。现如今的逆向工程的目的可以分为三类：

* 去除软件的使用限制或者对软件的功能的添加
* 软件源代码的获得
* 硬件的复制和模拟

通常逆向分析技术中所要用到的方法无非就是：

* 通过软件使用说明分析软件
* 使用静态分析技术(得到程序清单)
* 使用动态分析技术(分析程序运行)
  * 对软件进行粗跟踪，即只关注软件的程序块
  * 对关键部分进行细跟踪，即关注关键部分的代码流程。

## 关于操作系统

首先关于字符的表示，我们一般知道的字符表示是ascii标准，但是在windows中使用的是unicode码，并且以小端方式保存。

在windows中，windows应用程序的编写经常和Windows API打交道，只有通过API才能将其转换为系统服务调用。所以分析windows程序一个重要的点在于熟悉API的调用方法。Windows的核心是动态链接技术，程序多数是采用动态链接库实现的。

### WOW64

WOW64是64位操作系统的子系统，它的存在使得32位的应用程序能够步进行修改运行在64位系统上。

64位系统中自带32位系统的系统文件，其中系统中System32文件夹中存放了64位映像文件，而sysWOW64文件夹存储了32位系统文件。当系统运行了64位的应用程序，则会加载Sys32下的kernel32.dll，user32.dll和ntdll.dll，但是一旦加载的是32位的则WOW64会调用32位的ntdll.dll，这样CPU切换为32位的模式并且执行32位加载器；随后WOW64对32位的ntdll.dll重定向到64位的，然后发出对应64位的系统调用，在返回时切换回32位的。

### 消息机制

在windows系统中应用程序之间，和系统之间都是使用消息来通信的，windows系统中有两个消息队列，一个是系统的一个是应用程序的。当系统获得消息信息时，先加载到系统消息队列中，随后再复制到对应的应用程序队列中，然后由应用程序的消息循环将消息发送给窗口函数。

### 虚拟内存

32位的系统地址空间在4GB以内，所谓虚拟内存是通过映射的方法使可以用到的虚拟地址空间达到4GB，但是每个应用程序可以获得2GB的地址，剩下2GB留给操作系统。注意每个应用程序都有自己的4GB寻址空间，互不干扰。注意每次给应用程序分配的是2GB虚拟地址空间，不是真正的物理内存。

