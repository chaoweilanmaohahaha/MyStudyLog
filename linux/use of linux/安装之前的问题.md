# 杂项

## 与硬件的搭配

对于不同任务的主机所需要的硬件设备并不相同， 对于将 Linux 作为小型服务器来使用，按照如下思路考虑：

* CPU：没有太大的要求，只要不算太旧性能不错就行。如果需要多的运算则高级一点，比如如果是桌面型的带 X-Window 的就需要 i5~i7 朝上最好，用作其他中型服务器的更是如此。
* 内存：越大越好，因为如果内存不足就会使用到硬盘的交换分区。如果是带 X-Window 的更是如此。
* 硬盘：硬盘的考虑要看需求，对于小型服务器而言看重的是容量，所以从容量维度的多少来看待；那么假设对于文件服务器这种，看重的就是稳定和持久，所以需要考虑高级的 RAID。
* 显卡：如果没有使用 X-Window 则显卡是一个不重要的组件，否则需要配备具有一定显存容量的显卡。
* 其他外设：比如光盘、软盘、键盘等外设，这些都不是必备的。

## 硬件与文件

硬件在 Linux 的角色就是一个文件，即每个设备都被当成一个文件来对待。比如 SATA 接口的硬盘的文件名为 /dev/sd[a - d] (一般设备都在 /dev 下)。而如果使用的是虚拟机，像硬盘映射得到的文件名可能是 /dev/vd[a - d]。

## 分区

一块大的磁盘可以划分为多个分区，比如 Windows 上存在 C、D 盘，这就是将磁盘分区了。在上面已经看到设备在系统中的命名，那么这种命名是否存在着顺序？答案是**命名是根据 Linux 内核检测到磁盘的顺序命名的**。

整块磁盘的第一个扇区是最为重要的，因为它早期记录着称为 MBR 的重要信息，但是随着磁盘的容量迅速增长，于是在后来出现了新的分区格式 GPT。

### MBR

在最初使用 MBR 分区表的时期，分区的最小单位是柱面，也是文件系统的最小单位。早期的 Linux 兼容 Windows 磁盘，支持 Windows 的 MBR 方式处理启动引导程序和分区表，它将引导程序和分区表都放在了磁盘的第一扇区(512 字节)：

* 引导程序：446 字节；
* 分区表：64 字节；

由于分区表只有 64 字节，因此最多只有四组记录区，只能记录区段的起始和结束的柱面号码，而这四个分区记录又被称为主要分区(Primary) 或着扩展分区(Extended)。为什么要进行分区？一方面这是数据隔离，使得比如在未来重新安装系统的时候不会影响其他分区的数据，另一方面也优化了数据查找的性能。

但是一般而言一块硬盘理论上不止能够切分 4 个分区，要想有更多的分区就需要用到**扩展分区**。既然第一个扇区的分区表只能记录四个分区，那么对于扩展分区而言它就利用其他扇区来记录更多分区信息，**扩展分区本身不能拿来格式化**！扩展分区记录区会记录额外切分出来的分区信息，这些分区被称为**逻辑分区**，也就是说逻辑分区是由扩展分区继续划分的。

总结一下分区特性，扩展分区加主分区一共只有 4 个，而扩展分区受操作系统限制最多只有一个，而且逻辑分区的编号有其特殊性，由于对于一个 sda 磁盘，如果对他进行分区最多可以得到 sda1-4 四片区域。而假设设置了逻辑分区，则默认从 sda5 开始向后编号，因为 1-4 是预留给主分区和扩展分区的。

### GPT

使用 MBR 能使用的磁盘容量会受到限制，并且引导程序代码也只能限制在 446 字节。GPT 分区表用来解决这些问题，过去的一个扇区只有 512 字节，但是目前已经有 4K 大小的扇区出现，为了兼容所有的磁盘大多会使用所谓的逻辑区块地址(LBA)。GPT 将磁盘的所有区块一次 LBA 来规划，使用前 34 个 LBA 记录分区信息，最后 34 个 LBA 作为备份。其中 LBA0 是 MBR 兼容区块，在其中会放入一个 GPT 标识符；LBA1记录分区表的位置，LBA2-33 是实际的分区信息，而且每个 LBA 都能存储 4 组分区信息。所以对于 GPT 而言没有所谓主分区、扩展分区和逻辑分区，所有都是主分区可以被格式化。

## 引导

开机的第一步是要读取硬盘中的程序，这样认识了操作系统这个软件才能去执行它。

### BIOS

CMOS 记录了个相硬件参数并且这个记录被嵌在了主板的存储器上，而 BIOS 则是一个写入到主板上的固件。它是在启动的时候，计算机系统主动执行的第一个程序。BIOS 自己会分析计算机中的存储设备，随后识别能够启动的硬盘并获取其第一个扇区的 MBR。第一个扇区中的引导程序所做的就是加载内核文件，这是操作系统安装时所提供的，它能够认识硬盘中的文件系统格式。

所以 BIOS 和 MBR 都是硬件本身的功能，只有 Boot Loader 是操作系统安装的一个软件。Boot Loader 有许多的任务：

* 用户可以选择不同的引导项；
* 加载内核文件；
* 转交其他启动引导程序；

第三点的特性说明，**启动程序除了安装在 MBR 中，还可以安装在每个分区的启动扇区上**！这个特性造就了多重引导。每个分区都是存在自己的引导分区的，实际可启动的内核文件也是放置在各个分区中，启动引导程序只认识自己的系统分区内的可启动内核文件和其他引导程序。

### UEFI

UEFI 支持 64 位寻址，它的目的是取代 BIOS 这个固件接口，它类似一个比较低级的操作系统，一般而言使用 UEFI 的主机开机速度会快上许多。

## 目录与挂载

Linux 中最重要的就是目录数结构，整个目录数结构从根目录出发，表示的方法就是一个 /，所有的文件都和目录树有关。那么问题就是数据是在分区中，而如何通过目录树去寻找数据呢？这就是挂载。

所谓的**挂载是利用一个目录当成进入点，从而将数据放置在该目录下，所以相当于进入该目录就可以读取该分区**。所以在安装系统时需要考虑将一些比较特殊的目录独立出来，比如 /home，/var 等。

---

## 杂项

1. 注销不是关机，而是退出账户
2. Linux 默认情况下提供六个终端来让用户登录，其中以 Centos 为例。当处于登录界面时，可以通过 Ctrl + Alt + F1~F6 来切换。可以在命令行环境中启动 X-Window，使用 startx 命令就行。
3. Linux 是大小写敏感的。
4. 对于 Linux 的命令，如果不熟悉如何使用，一般查询的方法包括：
   * -- help 查看命令的帮助说明；
   * man 查看命令或者文件的具体用途，文件存放在/usr/share/man 下；
   * info 同 man，文件存放在 /usr/share/info 下；
   * 许多原版软件会在系统中留下一些文档，这些文档存放在 /usr/share/doc 中
5. who 可以看到谁在线；netstat -a 能够看到联网状态；ps -aux 能够查看后台程序情况。
6. shutdown、reboot、halt 等命令都已经在关机之前调用了 sync 程序了。